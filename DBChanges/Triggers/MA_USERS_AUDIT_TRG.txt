DROP TRIGGER AUDIT_STAG_TEST.MA_USERS_AUDIT_TRG;

CREATE OR REPLACE TRIGGER AUDIT_STAG_TEST."MA_USERS_AUDIT_TRG" 
   AFTER INSERT OR UPDATE
   ON ma_users
   FOR EACH ROW
BEGIN
 
   
   IF INSERTING
   THEN
        INSERT  INTO MA_USERS_AUDIT (FIRST_NAME, LAST_NAME, PASSWORD, COMPANY_ID, USER_INS, DATE_INS, USER_ID, PHONE_NO, ADDRESS, ACTIVE_STATUS, SEQUENCE_NUMBER, 
                                                             SIGNATURE, ISPS_REVIEW,VERIFICATION_CODE, ISM_REVIEW, MLC_REVIEW, REGION_ID, OFFICIAL_ID, TITLE, CHECK_USER, MANAGER_OFFICIAL_ID, 
                                                             UPDATED_BY, DATE_INS_AUDIT,INSERT_UPDATE_OPERATION ) 
                                                            VALUES (:NEW.FIRST_NAME, :NEW.LAST_NAME,  :NEW.PASSWORD, :NEW.COMPANY_ID, :NEW.USER_INS, :NEW.DATE_INS, :NEW.USER_ID, :NEW.PHONE_NO, :NEW.ADDRESS,
                                                              :NEW.ACTIVE_STATUS, :NEW.SEQUENCE_NUMBER, :NEW.SIGNATURE, :NEW.ISPS_REVIEW, :NEW.VERIFICATION_CODE, :NEW.ISM_REVIEW, :NEW.MLC_REVIEW, 
                                                              :NEW.REGION_ID, :NEW.OFFICIAL_ID, :NEW.TITLE, :NEW.CHECK_USER, :NEW.MANAGER_OFFICIAL_ID, :NEW.UPDATED_BY, sysdate, 'INSERT' );
    
   END IF;

IF UPDATING
THEN
  INSERT  INTO MA_USERS_AUDIT (FIRST_NAME, LAST_NAME, PASSWORD, COMPANY_ID, USER_INS, DATE_INS, USER_ID, PHONE_NO, ADDRESS, ACTIVE_STATUS, SEQUENCE_NUMBER, 
                                                             SIGNATURE, ISPS_REVIEW,VERIFICATION_CODE, ISM_REVIEW, MLC_REVIEW, REGION_ID, OFFICIAL_ID, TITLE, CHECK_USER, MANAGER_OFFICIAL_ID, 
                                                             UPDATED_BY, DATE_INS_AUDIT, INSERT_UPDATE_OPERATION ) 
                                                            VALUES (:OLD.FIRST_NAME, :OLD.LAST_NAME,  :OLD.PASSWORD, :OLD.COMPANY_ID, :OLD.USER_INS, :OLD.DATE_INS, :OLD.USER_ID, :OLD.PHONE_NO, :OLD.ADDRESS,
                                                              :OLD.ACTIVE_STATUS, :OLD.SEQUENCE_NUMBER, :OLD.SIGNATURE, :OLD.ISPS_REVIEW, :OLD.VERIFICATION_CODE, :OLD.ISM_REVIEW, :OLD.MLC_REVIEW, 
                                                              :OLD.REGION_ID, :OLD.OFFICIAL_ID, :OLD.TITLE, :OLD.CHECK_USER, :OLD.MANAGER_OFFICIAL_ID, :NEW.UPDATED_BY, sysdate, 'UPDATE' );
END IF;
   
END;
/

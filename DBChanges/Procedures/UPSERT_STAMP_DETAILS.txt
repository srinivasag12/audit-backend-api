CREATE OR REPLACE PROCEDURE AUDIT_STAG_TEST.UPSERT_STAMP_DETAILS
(
    v_FILE_NAME     VARCHAR2,
    v_CREATED_BY     VARCHAR2,
    v_CREATED_DATE   VARCHAR2,
    v_MODIFIED_DATE  VARCHAR2,
    v_PAGE_NO        VARCHAR2,
    v_USER_ID       NUMBER,
    v_REVIEW_REPORT_NO VARCHAR2,
    v_STAMP_DATE VARCHAR2,
    v_TOTAL_NO_PAGES VARCHAR2,
    v_ISSIGN VARCHAR2,
    v_ISSEAL VARCHAR2,
    v_POINTERS VARCHAR2,
    v_SIGNER VARCHAR2,
    v_SIGNER_NAME VARCHAR2,
    v_AUDIT_SEQ_NO NUMBER
   ) 
    AS
BEGIN
UPDATE STAMP_DETAILS
    SET MODIFIED_DATE = TO_DATE(v_MODIFIED_DATE, 'DD/MM/YYYY'),
        PAGE_NO = v_PAGE_NO, STAMP_DATE= TO_DATE(v_STAMP_DATE, 'DD/MM/YYYY'), ISSIGN= v_ISSIGN, ISSEAL= v_ISSEAL, POINTERS= v_POINTERS, SIGNER= v_SIGNER, SIGNER_NAME=v_SIGNER_NAME
    WHERE USER_ID = v_USER_ID and FILE_NAME = v_FILE_NAME and REVIEW_REPORT_NO=v_REVIEW_REPORT_NO and AUDIT_SEQ_NO=v_AUDIT_SEQ_NO;

IF ( sql%rowcount = 0 )
    THEN
    INSERT INTO STAMP_DETAILS (FILE_NAME,CREATED_BY,CREATED_DATE,PAGE_NO,USER_ID,REVIEW_REPORT_NO,STAMP_DATE,TOTAL_NO_PAGES,ISSIGN,ISSEAL, POINTERS,SIGNER,SIGNER_NAME,AUDIT_SEQ_NO) 
        VALUES (v_FILE_NAME,v_CREATED_BY,TO_DATE(v_CREATED_DATE, 'DD/MM/YYYY'),v_PAGE_NO,v_USER_ID,v_REVIEW_REPORT_NO,TO_DATE(v_STAMP_DATE, 'DD/MM/YYYY'),v_TOTAL_NO_PAGES,v_ISSIGN,v_ISSEAL,v_POINTERS, v_SIGNER,v_SIGNER_NAME,v_AUDIT_SEQ_NO);
END IF;


END;
/
